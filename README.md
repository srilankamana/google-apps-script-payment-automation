# 支払い通知書PDF作成・保存自動化 (Google Apps Script)

## 概要 (Overview)
Googleスプレッドシートで管理されている支払い情報を元に、取引先（エージェント）ごとに支払い通知書シートを自動生成し、PDFとしてGoogleドライブの指定フォルダに保存、管理表のステータスを更新するGoogle Apps Scriptプロジェクトです。

## 背景・課題 (Problem / Goal)
毎月発生する支払い通知書の作成において、管理表からの手作業による転記、シートの複製、PDF化、フォルダ保存といった定型作業に時間がかかり、ミスが発生しやすいという課題がありました。このスクリプトは、これらのプロセスを自動化し、業務効率化とヒューマンエラー削減を目指しました。

## 解決策 (Solution)
Google Apps Script (JavaScriptベース) を使用し、以下の処理を自動化しました。
1.  **データ取得:** 指定された管理表スプレッドシートから当月分の支払いデータを読み込みます。
2.  **フィルタリング:** 支払い月（T列）が当月、かつステータス（Z列）が空欄のデータのみを対象とします。
3.  **グループ化:** エージェント名（Q列）でデータをグループ化します。
4.  **シート生成:** エージェントごとに支払い明細書フォーマットシートをコピーし、ファイル名を自動生成します (`yyyymm_エージェント名様_支払い通知書`)。
5.  **データ転記:** 管理表のデータを明細書シートの指定セル（B4, F9, H14:S14, X14など）に転記します。明細が複数ある場合は行を自動挿入し、合計欄も自動で移動させます。
6.  **書式調整:** 特定のセル（採用企業名、振込先口座）の内容が長い場合、フォントサイズを自動調整します。
7.  **PDF生成:** 完成した各明細書シートを個別のPDFファイル（A4横、余白狭く、幅合わせ）として生成します。
8.  **ドライブ保存:** 生成したPDFを指定されたGoogleドライブフォルダ（フォルダIDで指定）に保存します。
9.  **ステータス更新:** PDFの保存が成功した行について、管理表のステータス（Z列）を「承認待ち」に更新します。

## 主な機能 (Key Features)
* スプレッドシート間のデータ転記自動化
* 条件に基づくデータフィルタリング
* データグルーピングによる複数シート生成
* 複数明細行の自動挿入とレイアウト調整
* 動的なフォントサイズ調整
* 個別シートのPDF自動生成とGoogleドライブへの保存
* 処理完了後のステータス自動更新

## 使用技術 (Technologies Used)
* Google Apps Script (JavaScript)
* Google Sheets API (SpreadsheetApp)
* Google Drive API (DriveApp)
* UrlFetch Service (PDF生成用)

## 注意点 (Important Notes)
* **機密情報:** このリポジトリには、実際のファイルID、フォルダID、メールアドレスなどの機密情報は含まれていません。実際の運用には、スクリプト内の設定項目（`▼▼▼`部分）を適切な値に書き換える必要があります。
* **エラー処理:** PDF生成失敗時やタグ更新失敗時にエラーメッセージを表示する簡易的なエラー処理が含まれています。
